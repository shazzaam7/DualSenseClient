<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ic="using:FluentIcons.Avalonia.Fluent"
             xmlns:vm="clr-namespace:DualSenseClient.ViewModels.Controls"
             x:Class="DualSenseClient.Views.Controls.ProfileSelector"
             x:DataType="vm:ControllerProfileViewModel">

    <UserControl.Styles>
        <Style Selector="Button.action-button">
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="MinWidth" Value="36" />
        </Style>
    </UserControl.Styles>

    <Border Background="{DynamicResource LayerFillColorDefaultBrush}"
            CornerRadius="6"
            HorizontalAlignment="Stretch"
            Padding="12">
        <Grid ColumnDefinitions="*,Auto">
            <!-- ComboBox with flexible width -->
            <ComboBox Name="ProfileComboBox"
                      Grid.Column="0"
                      ItemsSource="{Binding Profiles}"
                      SelectedItem="{Binding SelectedProfile}"
                      MinWidth="0"
                      Margin="0,0,8,4">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <Grid ColumnDefinitions="Auto,*">
                            <ic:SymbolIcon Symbol="ColorBackground"
                                           FontSize="12"
                                           Margin="0,0,6,0"
                                           VerticalAlignment="Center" />
                            <TextBlock Grid.Column="1"
                                       Text="{Binding Name}"
                                       VerticalAlignment="Center" />
                        </Grid>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <!-- Action Buttons -->
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        Spacing="4"
                        Margin="0,0,0,4"
                        HorizontalAlignment="Right">
                <Button Name="RenameButton"
                        ToolTip.Tip="Rename Profile"
                        Classes="action-button">
                    <ic:SymbolIcon Symbol="Edit" FontSize="14" />
                </Button>
                <Button Command="{Binding ApplySelectedProfileCommand}"
                        ToolTip.Tip="Apply Profile"
                        Classes="action-button">
                    <ic:SymbolIcon Symbol="Play" FontSize="14" />
                </Button>
                <Button Command="{Binding UpdateSelectedProfileCommand}"
                        ToolTip.Tip="Update Profile"
                        Classes="action-button">
                    <ic:SymbolIcon Symbol="Save" FontSize="14" />
                </Button>
                <Button Command="{Binding ExportProfileCommand}"
                        ToolTip.Tip="Export Profile"
                        Classes="action-button">
                    <ic:SymbolIcon Symbol="ArrowDownload" FontSize="14" />
                </Button>
                <Button Command="{Binding ImportProfileCommand}"
                        ToolTip.Tip="Import Profile"
                        Classes="action-button">
                    <ic:SymbolIcon Symbol="ArrowUpload" FontSize="14" />
                </Button>
                <Button Command="{Binding DuplicateSelectedProfileCommand}"
                        ToolTip.Tip="Duplicate Profile"
                        Classes="action-button">
                    <ic:SymbolIcon Symbol="Copy" FontSize="14" />
                </Button>
                <Button Command="{Binding DeleteSelectedProfileCommand}"
                        ToolTip.Tip="Delete Profile"
                        Classes="action-button">
                    <Button.Styles>
                        <Style Selector="Button:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemFillColorCriticalBrush}" />
                        </Style>
                    </Button.Styles>
                    <ic:SymbolIcon Symbol="Delete" FontSize="14" />
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>